# 添加开发后门功能

## 1. 功能需求
- 在第一关采药环节，当玩家连续输入三下 `===` 时，直接跳转到第四章
- 节省开发调试时间

## 2. 实现方案

### 修改文件
`Assets/Scripts/Core/Dialogue/DialogueSystem.cs`

### 实现思路
1. **在DialogueSystem中添加键盘监听**：利用其单例特性和Update方法，实现全局键盘监听
2. **输入检测逻辑**：记录玩家输入，当连续输入三个等号时触发跳转
3. **场景跳转**：使用SceneLoaderManager实现场景和剧情跳转

### 具体修改

#### 1. 添加输入跟踪变量
```csharp
// 开发后门相关变量
private string inputBuffer = ""; // 输入缓冲区
private const string CHEAT_CODE = "==="; // 作弊码
```

#### 2. 在Update方法中添加键盘监听
```csharp
// 开发后门：检测连续输入 ===
if (Input.anyKeyDown)
{
    // 获取按下的键
    string key = Input.inputString;
    if (!string.IsNullOrEmpty(key))
    {
        // 添加到输入缓冲区
        inputBuffer += key;
        
        // 只保留最后3个字符
        if (inputBuffer.Length > 3)
        {
            inputBuffer = inputBuffer.Substring(inputBuffer.Length - 3);
        }
        
        // 检测作弊码
        if (inputBuffer == CHEAT_CODE)
        {
            Debug.Log("Cheat code detected! Jumping to Chapter 4...");
            // 跳转到第四章
            CommandManager.instance.Execute("startdialogue", "-f", "41");
            // 清空输入缓冲区
            inputBuffer = "";
        }
    }
}
```

## 3. 预期效果

1. **在第一关采药环节**，玩家连续输入三个等号 `===`
2. **触发作弊码检测**，控制台输出调试信息
3. **直接跳转到第四章**，开始41.txt的剧情
4. **节省开发调试时间**，无需手动完成前面章节

## 4. 技术说明

- **单例设计**：利用DialogueSystem的单例特性，确保全局监听
- **输入缓冲区**：只保留最后3个字符，高效检测连续输入
- **CommandManager调用**：使用现有的命令系统，保持代码一致性
- **调试友好**：添加控制台日志，便于调试

## 5. 注意事项

- 作弊码区分大小写，需要输入三个连续的等号
- 只在游戏运行时有效，不影响游戏发布版本
- 跳转到第四章前，会自动初始化相关场景和角色

这个修改将为开发调试提供便利，节省大量时间，同时保持代码的简洁和可维护性。